--- ppm/ppmchange.c.orig	Tue Mar 20 12:28:14 2001
+++ ppm/ppmchange.c	Tue Mar 27 00:00:00 2001
@@ -14,6 +14,7 @@
 */
 
 #include "ppm.h"
+#include "shhopt.h"
 #define TCOLS 256
 #define SQRT3 1.73205080756887729352
     /* The square root of 3 */
@@ -50,10 +51,20 @@
 
     unsigned int option_def_index;
 
+    /* Create the OptStruct structure describing our options */
+    #define OPTENTRY(shortvalue,longvalue,typevalue,outputvalue,flagvalue) {\
+      option_def[option_def_index].shortName = (shortvalue); \
+      option_def[option_def_index].longName = (longvalue); \
+      option_def[option_def_index].type = (typevalue); \
+      option_def[option_def_index].arg = (outputvalue); \
+      option_def[option_def_index].flags = (flagvalue); \
+      option_def_index++; \
+      }
     option_def_index = 0;   /* incremented by OPTENTRY */
     OPTENTRY(0,   "closeness",     OPT_INT,    &cmdlineP->closeness,     0);
     OPTENTRY(0,   "remainder",     OPT_STRING, 
              &cmdlineP->remainder_colorname,         0);
+    option_def[option_def_index].type = OPT_END;
 
     /* Set the defaults */
     cmdlineP->closeness = 0;
@@ -63,7 +74,7 @@
     opt.short_allowed = FALSE;  /* We have no short (old-fashioned) options */
     opt.allowNegNum = FALSE;  /* We may have parms that are negative numbers */
 
-    pm_optParseOptions2(&argc, argv, opt, 0);
+    optParseOptions2(&argc, argv, opt, 0);
         /* Uses and sets argc, argv, and some of *cmdlineP and others. */
 
     if ((argc-1) % 2 == 0) 
